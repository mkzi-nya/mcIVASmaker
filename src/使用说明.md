---

## 🛠 Minecraft IVAS Maker CLI 手册

CLI 可以将图片或视频转换为 Minecraft 任意方块或红石灯的 **图片 / Schematic**。
核心算法与 GUI 完全相同，只是通过命令行运行，适合批处理或服务器环境。

---

### 基本语法

```bash
python -m src.cli <命令> [子参数...] [通用参数...]
```

命令分为两大类：

* **image**：处理单张图片
* **video**：处理视频

---

## 1. 处理图片

```bash
python -m src.cli image <输出类型> -i 输入图片 [选项...]
```

### 输出类型 `<输出类型>`（必填）

* `any-image` → 输出任意方块图片（PNG）
* `any-schem` → 输出任意方块 Schematic 文件
* `lamps-image` → 输出红石灯图片（PNG）
* `lamps-schem` → 输出红石灯 Schematic 文件

### 必填参数

| 参数                 | 说明     |
| ------------------ | ------ |
| `-i, --input <路径>` | 输入图片路径 |

### 可选参数

| 参数                        | 默认值                             | 说明                           |
| ------------------------- | ------------------------------- | ---------------------------- |
| `-o, --output <路径>`       | 无（自动生成到 `./mcIVASMAKER_output`） | 输出文件路径                       |
| `--scale <百分比>`           | `100`                           | 缩放比例（整数百分比，如 `100` 表示 100%）  |
| `--crop <x1,y1,x2,y2>`    | 无                               | 裁剪区域，`x2`/`y2` 可用 `max` 表示最大 |
| `--brightness <0-255>`    | `127`                           | 红石灯模式阈值                      |
| `--dither`                | False                           | 红石灯模式使用抖动                    |
| `--alternate`             | False                           | 红石灯 alternate 模式             |
| `--place-redstone-blocks` | False                           | 红石灯 schematic 下方放置红石块        |

### 通用方块参数（图片/视频通用）

| 参数                     | 默认值                     | 说明                                                                                                 |
| ---------------------- | ----------------------- | -------------------------------------------------------------------------------------------------- |
| `--side`               | `top`                   | 方块贴图采样面，取值：`top`/`bottom`/`north`/`south`/`east`/`west`                                            |
| `--mode`               | `All`                   | 方块筛选模式，取值：`All`/`Whitelist`/`Blacklist`                                                            |
| `--blocklist <方块...>`  | 无                       | 白/黑名单方块英文名                                                                                         |
| `--color-set <模式>`     | `"Linear Average"`      | 颜色聚合方式（依数据集命名，可用 `"RMS Average"`/`"HSL"`/`"HSV"`/`"Lab"`/`"Dominant"` 等）                           |
| `--color-compare <算法>` | `"Absolute Difference"` | 颜色差异算法（可用 `"Euclidean Difference"`/`"Weighted Euclidean"`/`"Redmean Difference"`/`"CIE76 DelE"` 等） |

---

## 2. 处理视频

```bash
python -m src.cli video <输出类型> -i 输入视频 [选项...]
```

### 输出类型 `<输出类型>`（必填）

* `any-image` → 输出任意方块视频（mp4）
* `any-schem` → 输出任意方块 Schematic 序列（组合为视频）
* `lamps-image` → 输出红石灯视频（mp4）
* `lamps-schem` → 输出红石灯 Schematic 序列（组合为视频）

### 必填参数

| 参数                 | 说明     |
| ------------------ | ------ |
| `-i, --input <路径>` | 输入视频路径 |

### 可选参数

| 参数                     | 默认值                             | 说明                              |
| ---------------------- | ------------------------------- | ------------------------------- |
| `-o, --output <路径>`    | 无（自动生成到 `./mcIVASMAKER_output`） | 输出文件路径                          |
| `--scale <百分比>`        | `100`                           | 缩放比例                            |
| `--fps <整数>`           | `12`                            | 抽帧帧率                            |
| `--quality`            | False                           | 使用 PNG 中间帧（更高质量但更慢，不加此参数则用 JPG） |
| `--brightness <0-255>` | `127`                           | 红石灯模式阈值                         |
| `--dither`             | False                           | 红石灯模式使用抖动                       |
| `--alternate`          | False                           | 红石灯 alternate 模式                |
| `--processes <1-16>`   | `2`                             | 并行处理进程数                         |

### 通用方块参数

同上 **图片模式的通用方块参数表**。

---

## 示例

1. **将图片转换为任意方块图片**（100% 缩放，默认色彩设置）：

```bash
python -m src.cli image any-image -i steve.png --scale 100
```

2. **将图片转换为红石灯 Schematic**（亮度阈值 140，使用抖动）：

```bash
python -m src.cli image lamps-schem -i logo.png --brightness 140 --dither
```

3. **将视频转换为任意方块视频**（15 fps，高质量 PNG 中间帧）：

```bash
python -m src.cli video any-image -i demo.mp4 --fps 15 --quality
```

4. **将视频转换为红石灯视频**（阈值 150，alternate 模式，并行 4 进程）：

```bash
python -m src.cli video lamps-image -i demo.mp4 --brightness 150 --alternate --processes 4
```

5. **使用白名单方块 + 自定义颜色算法处理图片**：

```bash
python -m src.cli image any-image -i art.png --mode Whitelist --blocklist "minecraft:oak_planks" "minecraft:stone" --color-set "HSL" --color-compare "CIE76 DelE"
```

---

## 输出文件

* 若未指定 `-o/--output`，则：

  * 图片输出：`./mcIVASMAKER_output/outputYY_MM_DD-HH_MM_SS.png`
  * Schematic 输出：`./mcIVASMAKER_output/outputYY_MM_DD-HH_MM_SS.schem`
  * 视频输出：`./mcIVASMAKER_output/outputYY_MM_DD-HH_MM_SS.mp4`

---